{"version":3,"sources":["components/Tile/Tile.js","CallObjectContext.js","components/CallMessage/CallMessage.js","components/Call/callState.js","logUtils.js","components/Call/Call.js","components/StartButton/StartButton.js","api.js","components/Icon/Icon.js","components/TrayButton/TrayButton.js","components/Tray/Tray.js","components/App/App.js","index.js","urlUtils.js","components/BrowserUnsupported/BrowserUnsupported.js"],"names":["Tile","props","videoEl","useRef","audioEl","useEffect","current","srcObject","MediaStream","videoTrack","audioTrack","className","classNames","isLarge","isLocalPerson","getClassNames","onClick","isLoading","autoPlay","muted","playsInline","ref","React","createContext","CallMessage","isError","header","detail","initialCallState","callItems","local","clickAllowTimeoutFired","camOrMicError","fatalError","callReducer","callState","action","type","participants","prevCallItems","Object","entries","id","participant","hasLoaded","missingTracks","screenVideoTrack","screenAudioTrack","getCallItems","message","Error","isLocal","isScreenShare","endsWith","logDailyEvent","e","console","log","Call","callObject","useContext","CallObjectContext","useReducer","dispatch","events","handleNewParticipantsState","event","on","off","handleCameraErrorEvent","errorMsg","handleErrorEvent","t","setTimeout","clearTimeout","sendHello","useCallback","participantId","sendAppMessage","hello","largeTiles","smallTiles","forEach","callItem","keys","some","tile","key","push","getTiles","localCallItem","shouldShowClickAllow","length","window","location","href","getMessage","StartButton","disabled","newRoomEndpoint","a","fetch","response","json","room","createRoom","Icon","getFillColor","highlighted","width","height","viewBox","xmlns","stroke","strokeWidth","fill","fillRule","transform","d","getPath","TrayButton","newButtonGroup","Tray","useState","isCameraMuted","setCameraMuted","isMicMuted","setMicMuted","isSharingScreen","setSharingScreen","localParticipant","video","audio","screen","getStreamStates","setLocalVideo","setLocalAudio","DailyIframe","supportedBrowser","supportsScreenShare","stopScreenShare","startScreenShare","onClickLeaveCall","STATE_JOINING","STATE_JOINED","STATE_ERROR","ReactDOM","render","supported","appState","setAppState","roomUrl","setRoomUrl","setCallObject","createCall","api","then","url","catch","error","startJoiningCall","newCallObject","createCallObject","join","startLeavingCall","leave","match","search","decodeURIComponent","roomUrlFromPageUrl","pageUrl","split","encodeURIComponent","pageUrlFromRoomUrl","history","replaceState","handleNewMeetingState","meetingState","destroy","handleAppMessage","fromId","data","showCall","includes","enableCallButtons","enableStartButton","Provider","value","class","document","getElementById"],"mappings":"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","file":"static/js/main.d5b13add.chunk.js","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport './Tile.css';\n\n/**\n * Props\n * - videoTrack: MediaStreamTrack?\n * - audioTrack: MediaStreamTrack?\n * - isLocalPerson: boolean\n * - isLarge: boolean\n * - isLoading: boolean\n * - onClick: Function\n */\nexport default function Tile(props) {\n  const videoEl = useRef(null);\n  const audioEl = useRef(null);\n\n  /**\n   * When video track changes, update video srcObject\n   */\n  useEffect(() => {\n    videoEl.current &&\n      (videoEl.current.srcObject = new MediaStream([props.videoTrack]));\n  }, [props.videoTrack]);\n\n  /**\n   * When audio track changes, update audio srcObject\n   */\n  useEffect(() => {\n    audioEl.current &&\n      (audioEl.current.srcObject = new MediaStream([props.audioTrack]));\n  }, [props.audioTrack]);\n\n  function getLoadingComponent() {\n    return props.isLoading && <p className=\"loading\">Loading...</p>;\n  }\n\n  function getVideoComponent() {\n    return (\n      props.videoTrack && <video autoPlay muted playsInline ref={videoEl} />\n    );\n  }\n\n  function getAudioComponent() {\n    return (\n      !props.isLocalPerson &&\n      props.audioTrack && <audio autoPlay playsInline ref={audioEl} />\n    );\n  }\n\n  function getClassNames() {\n    let classNames = 'tile';\n    classNames += props.isLarge ? ' large' : ' small';\n    props.isLocalPerson && (classNames += ' local');\n    return classNames;\n  }\n\n  return (\n    <div className={getClassNames()} onClick={props.onClick}>\n      <div className=\"background\" />\n      {getLoadingComponent()}\n      {getVideoComponent()}\n      {getAudioComponent()}\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default React.createContext();\n","import React from 'react';\nimport './CallMessage.css';\n\n/**\n * Props:\n * - header: string\n * - detail: string\n * - isError: boolean\n */\nexport default function CallMessage(props) {\n  return (\n    <div className={'call-message' + (props.isError ? ' error' : '')}>\n      <p className=\"call-message-header\">{props.header}</p>\n      <p>{props.detail}</p>\n    </div>\n  );\n}\n","/**\n * Call state is comprised of:\n * - \"Call items\" (inputs to the call, i.e. participants or shared screens)\n * - UI state that depends on call items (for now, just whether to show \"click allow\" message)\n *\n * Call items are keyed by id:\n * - \"local\" for the current participant\n * - A session id for each remote participant\n * - \"<id>-screen\" for each shared screen\n */\nconst initialCallState = {\n  callItems: {\n    local: {\n      isLoading: true,\n      audioTrack: null,\n      videoTrack: null,\n    },\n  },\n  clickAllowTimeoutFired: false,\n  camOrMicError: null,\n  fatalError: null,\n};\n\n// --- Actions ---\n\n/**\n * CLICK_ALLOW_TIMEOUT action structure:\n * - type: string\n */\nconst CLICK_ALLOW_TIMEOUT = 'CLICK_ALLOW_TIMEOUT';\n\n/**\n * PARTICIPANTS_CHANGE action structure:\n * - type: string\n * - participants: Object (from Daily.co callObject.participants())\n */\nconst PARTICIPANTS_CHANGE = 'PARTICIPANTS_CHANGE';\n\n/**\n * CAM_OR_MIC_ERROR action structure:\n * - type: string\n * - message: string\n */\nconst CAM_OR_MIC_ERROR = 'CAM_OR_MIC_ERROR';\n\n/**\n * CAM_OR_MIC_ERROR action structure:\n * - type: string\n * - message: string\n */\nconst FATAL_ERROR = 'FATAL_ERROR';\n\n// --- Reducer and helpers --\n\nfunction callReducer(callState, action) {\n  switch (action.type) {\n    case CLICK_ALLOW_TIMEOUT:\n      return {\n        ...callState,\n        clickAllowTimeoutFired: true,\n      };\n    case PARTICIPANTS_CHANGE:\n      const callItems = getCallItems(action.participants, callState.callItems);\n      return {\n        ...callState,\n        callItems,\n      };\n    case CAM_OR_MIC_ERROR:\n      return { ...callState, camOrMicError: action.message };\n    case FATAL_ERROR:\n      return { ...callState, fatalError: action.message };\n    default:\n      throw new Error();\n  }\n}\n\nfunction getLocalCallItem(callItems) {\n  return callItems['local'];\n}\n\nfunction getCallItems(participants, prevCallItems) {\n  let callItems = { ...initialCallState.callItems }; // Ensure we *always* have a local participant\n  for (const [id, participant] of Object.entries(participants)) {\n    // Here we assume that a participant will join with audio/video enabled.\n    // This assumption lets us show a \"loading\" state before we receive audio/video tracks.\n    // This may not be true for all apps, but the call object doesn't yet support distinguishing\n    // between cases where audio/video are missing because they're still loading or muted.\n    const hasLoaded = prevCallItems[id] && !prevCallItems[id].isLoading;\n    const missingTracks = !(participant.audioTrack || participant.videoTrack);\n    callItems[id] = {\n      isLoading: !hasLoaded && missingTracks,\n      audioTrack: participant.audioTrack,\n      videoTrack: participant.videoTrack,\n    };\n    if (participant.screenVideoTrack || participant.screenAudioTrack) {\n      callItems[id + '-screen'] = {\n        isLoading: false,\n        videoTrack: participant.screenVideoTrack,\n        audioTrack: participant.screenAudioTrack,\n      };\n    }\n  }\n  return callItems;\n}\n\n// --- Derived data ---\n\n// True if id corresponds to local participant (*not* their screen share)\nfunction isLocal(id) {\n  return id === 'local';\n}\n\nfunction isScreenShare(id) {\n  return id.endsWith('-screen');\n}\n\nfunction containsScreenShare(callItems) {\n  return Object.keys(callItems).some((id) => isScreenShare(id));\n}\n\nfunction getMessage(callState) {\n  function shouldShowClickAllow() {\n    const localCallItem = getLocalCallItem(callState.callItems);\n    const hasLoaded = localCallItem && !localCallItem.isLoading;\n    return !hasLoaded && callState.clickAllowTimeoutFired;\n  }\n\n  let header = null;\n  let detail = null;\n  let isError = false;\n  if (callState.fatalError) {\n    header = `Fatal error: ${callState.fatalError}`;\n    isError = true;\n  } else if (callState.camOrMicError) {\n    header = `Camera or mic access error: ${callState.camOrMicError}`;\n    detail =\n      'See https://help.daily.co/en/articles/2528184-unblock-camera-mic-access-on-a-computer to troubleshoot.';\n    isError = true;\n  } else if (shouldShowClickAllow()) {\n    header = 'Click \"Allow\" to enable camera and mic access';\n  } else if (Object.keys(callState.callItems).length === 1) {\n    header = \"Copy and share this page's URL to invite others\";\n    detail = window.location.href;\n  }\n  return header || detail ? { header, detail, isError } : null;\n}\n\nexport {\n  initialCallState,\n  CLICK_ALLOW_TIMEOUT,\n  PARTICIPANTS_CHANGE,\n  CAM_OR_MIC_ERROR,\n  FATAL_ERROR,\n  callReducer,\n  isLocal,\n  isScreenShare,\n  containsScreenShare,\n  getMessage,\n};\n","export function logDailyEvent(e) {\n  console.log('[daily.co event]', e.action);\n}\n","import React, { useEffect, useContext, useReducer, useCallback } from 'react';\nimport './Call.css';\nimport Tile from '../Tile/Tile';\nimport CallObjectContext from '../../CallObjectContext';\nimport CallMessage from '../CallMessage/CallMessage';\nimport {\n  initialCallState,\n  CLICK_ALLOW_TIMEOUT,\n  PARTICIPANTS_CHANGE,\n  CAM_OR_MIC_ERROR,\n  FATAL_ERROR,\n  callReducer,\n  isLocal,\n  isScreenShare,\n  containsScreenShare,\n  getMessage,\n} from './callState';\nimport { logDailyEvent } from '../../logUtils';\n\nexport default function Call() {\n  const callObject = useContext(CallObjectContext);\n  const [callState, dispatch] = useReducer(callReducer, initialCallState);\n\n  /**\n   * Start listening for participant changes, when the callObject is set.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    const events = [\n      'participant-joined',\n      'participant-updated',\n      'participant-left',\n    ];\n\n    function handleNewParticipantsState(event) {\n      event && logDailyEvent(event);\n      dispatch({\n        type: PARTICIPANTS_CHANGE,\n        participants: callObject.participants(),\n      });\n    }\n\n    // Use initial state\n    handleNewParticipantsState();\n\n    // Listen for changes in state\n    for (const event of events) {\n      callObject.on(event, handleNewParticipantsState);\n    }\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      for (const event of events) {\n        callObject.off(event, handleNewParticipantsState);\n      }\n    };\n  }, [callObject]);\n\n  /**\n   * Start listening for call errors, when the callObject is set.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleCameraErrorEvent(event) {\n      logDailyEvent(event);\n      dispatch({\n        type: CAM_OR_MIC_ERROR,\n        message:\n          (event && event.errorMsg && event.errorMsg.errorMsg) || 'Unknown',\n      });\n    }\n\n    // We're making an assumption here: there is no camera error when callObject\n    // is first assigned.\n\n    callObject.on('camera-error', handleCameraErrorEvent);\n\n    return function cleanup() {\n      callObject.off('camera-error', handleCameraErrorEvent);\n    };\n  }, [callObject]);\n\n  /**\n   * Start listening for fatal errors, when the callObject is set.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleErrorEvent(e) {\n      logDailyEvent(e);\n      dispatch({\n        type: FATAL_ERROR,\n        message: (e && e.errorMsg) || 'Unknown',\n      });\n    }\n\n    // We're making an assumption here: there is no error when callObject is\n    // first assigned.\n\n    callObject.on('error', handleErrorEvent);\n\n    return function cleanup() {\n      callObject.off('error', handleErrorEvent);\n    };\n  }, [callObject]);\n\n  /**\n   * Start a timer to show the \"click allow\" message, when the component mounts.\n   */\n  useEffect(() => {\n    const t = setTimeout(() => {\n      dispatch({ type: CLICK_ALLOW_TIMEOUT });\n    }, 2500);\n\n    return function cleanup() {\n      clearTimeout(t);\n    };\n  }, []);\n\n  /**\n   * Send an app message to the remote participant whose tile was clicked on.\n   */\n  const sendHello = useCallback(\n    (participantId) => {\n      callObject &&\n        callObject.sendAppMessage({ hello: 'world' }, participantId);\n    },\n    [callObject]\n  );\n\n  function getTiles() {\n    let largeTiles = [];\n    let smallTiles = [];\n    Object.entries(callState.callItems).forEach(([id, callItem]) => {\n      const isLarge =\n        isScreenShare(id) ||\n        (!isLocal(id) && !containsScreenShare(callState.callItems));\n      const tile = (\n        <Tile\n          key={id}\n          videoTrack={callItem.videoTrack}\n          audioTrack={callItem.audioTrack}\n          isLocalPerson={isLocal(id)}\n          isLarge={isLarge}\n          isLoading={callItem.isLoading}\n          onClick={\n            isLocal(id)\n              ? null\n              : () => {\n                  sendHello(id);\n                }\n          }\n        />\n      );\n      if (isLarge) {\n        largeTiles.push(tile);\n      } else {\n        smallTiles.push(tile);\n      }\n    });\n    return [largeTiles, smallTiles];\n  }\n\n  const [largeTiles, smallTiles] = getTiles();\n  const message = getMessage(callState);\n  return (\n    <div className=\"call\">\n      <div className=\"large-tiles\">\n        {\n          !message\n            ? largeTiles\n            : null /* Avoid showing large tiles to make room for the message */\n        }\n      </div>\n      <div className=\"small-tiles\">{smallTiles}</div>\n      {message && (\n        <CallMessage\n          header={message.header}\n          detail={message.detail}\n          isError={message.isError}\n        />\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport './StartButton.css';\n\n/**\n * Props:\n * - disabled: boolean\n * - onClick: () => ()\n */\nexport default function StartButton(props) {\n  return (\n    <button\n      className=\"start-button\"\n      disabled={props.disabled}\n      onClick={props.onClick}\n    >\n      Click to start a call\n    </button>\n  );\n}\n","const newRoomEndpoint =\n  'https://fu6720epic.execute-api.us-west-2.amazonaws.com/default/dailyWwwApiDemoNewCall';\n\n/**\n * Create a short-lived room for demo purposes.\n *\n * IMPORTANT: this is purely a \"demo-only\" API, and *not* how we recommend\n * you create rooms in real production code. In your code, we recommend that you:\n * - Create rooms by invoking the Daily.co REST API from your own backend server\n *   (or from the Daily.co dashboard if you're OK with creating rooms manually).\n * - Pass an \"exp\" (expiration) parameter to the Daily.co REST endpoint so you\n *   don't end up with a huge number of live rooms.\n *\n * See https://docs.daily.co/reference#create-room for more information on how\n * to use the Daily.co REST API to create rooms.\n */\nasync function createRoom() {\n  let response = await fetch(newRoomEndpoint),\n    room = await response.json();\n  return room;\n\n  // Comment out the above and uncomment the below, using your own URL\n  // return { url: \"https://your-domain.daily.co/hello\" };\n}\n\nexport default { createRoom };\n","import React from 'react';\n\nconst TYPE_MUTE_CAMERA = 'camera';\nconst TYPE_MUTE_MIC = 'mute-mic';\nconst TYPE_SCREEN = 'screen';\nconst TYPE_LEAVE = 'leave';\n\n/**\n * Props:\n * - type: string\n * - highlighted: boolean\n */\nexport default function Icon(props) {\n  function getFillColor() {\n    return props.highlighted ? '#fb5554' : '#000000';\n  }\n\n  function getPath() {\n    switch (props.type) {\n      case TYPE_MUTE_CAMERA:\n        return (\n          <g\n            id=\"Symbols\"\n            stroke=\"none\"\n            strokeWidth=\"1\"\n            fill=\"none\"\n            fillRule=\"evenodd\"\n          >\n            <g\n              id=\"Assets-for-Export\"\n              transform=\"translate(-24.000000, 0.000000)\"\n              fill={getFillColor()}\n            >\n              <g\n                id=\"Icon-Camera-Off-24px\"\n                transform=\"translate(24.000000, 0.000000)\"\n              >\n                <path\n                  d=\"M13.7573593,6 L4.00585866,6 C2.89706013,6 2,6.8992496 2,8.0085302 L2,15.9914698 C2,16.4835828 2.17760958,16.9352259 2.47229113,17.2850682 L13.7573593,6 Z M16,12.2426407 L16,15.9914698 C16,17.1007504 15.1029399,18 13.9941413,18 L10.2426407,18 L16,12.2426407 Z M16,12.2426407 L16,14.499966 L21.0756492,16.6148096 C21.586154,16.8275189 22,16.5442917 22,16.0045612 L22,7.99539512 C22,7.44565489 21.5875957,7.17183667 21.0756492,7.38514669 L20.7016702,7.54097052 L16,12.2426407 Z M20.4877316,2.09805481 C20.8769027,1.70888376 21.506248,1.70725811 21.8994949,2.10050506 C22.2900192,2.49102936 22.2956069,3.1186067 21.9019452,3.51226838 L3.51226838,21.9019452 C3.12309732,22.2911162 2.49375202,22.2927419 2.10050506,21.8994949 C1.70998077,21.5089706 1.70439313,20.8813933 2.09805481,20.4877316 L20.4877316,2.09805481 Z\"\n                  id=\"Combined-Shape\"\n                ></path>\n              </g>\n            </g>\n          </g>\n        );\n      case TYPE_MUTE_MIC:\n        return (\n          <g\n            id=\"Symbols\"\n            stroke=\"none\"\n            strokeWidth=\"1\"\n            fill=\"none\"\n            fillRule=\"evenodd\"\n          >\n            <g\n              id=\"Assets-for-Export\"\n              transform=\"translate(-120.000000, 0.000000)\"\n              fill={getFillColor()}\n            >\n              <g\n                id=\"Icon-Microphone-Off-24px\"\n                transform=\"translate(120.000000, 0.000000)\"\n              >\n                <path\n                  d=\"M15.8931049,12.3495358 L15.8883757,12.354265 C15.7702192,12.7237203 15.5976472,13.0928313 15.3634551,13.4334743 C14.9080287,14.0959127 14.281481,14.5761112 13.4232304,14.8194102 L11,17.2426407 L11,18.9906311 C11,18.9937578 11.0000137,18.9968808 11.0000409,19 L9.99077797,19 C9.45097518,19 9,19.4477153 9,20 C9,20.5561352 9.44358641,21 9.99077797,21 L14.009222,21 C14.5490248,21 15,20.5522847 15,20 C15,19.4438648 14.5564136,19 14.009222,19 L12.9999626,19 C12.999986,18.9968804 13,18.9937574 13,18.9906311 L13,16.9383953 C14.793746,16.7093537 16.1268712,15.8533183 17.0115375,14.566531 C17.631941,13.6641258 17.9116422,12.769082 17.9922726,12.124039 C18.0567667,11.6080864 17.715976,11.1348845 17.2185349,11.0241058 L17.2162194,11.0264213 C17.1758852,11.0160463 17.1430789,11.0101085 17.12403,11.0077274 C16.5760096,10.9392248 16.076219,11.3279514 16.0077165,11.8759725 C15.9990827,11.9450424 15.9659776,12.1062504 15.8970768,12.3267333 C15.8944966,12.3349898 15.8931939,12.3425837 15.8931049,12.3495358 Z M14.8100942,4.94726512 C14.3837386,3.80970165 13.2864273,3 12,3 C10.3431458,3 9,4.34314575 9,6 L9,10.7573593 L14.8100942,4.94726512 Z M7.97590142,11.7814579 C7.86511978,11.2840207 7.39191988,10.9432336 6.87596978,11.0077274 C6.32795032,11.0762298 5.93922497,11.5760196 6.0077274,12.124039 C6.05291889,12.4855709 6.16064541,12.9256367 6.35584336,13.401516 L7.97590142,11.7814579 Z M20.4877316,2.09805481 C20.8769027,1.70888376 21.506248,1.70725811 21.8994949,2.10050506 C22.2900192,2.49102936 22.2956069,3.1186067 21.9019452,3.51226838 L3.51226838,21.9019452 C3.12309732,22.2911162 2.49375202,22.2927419 2.10050506,21.8994949 C1.70998077,21.5089706 1.70439313,20.8813933 2.09805481,20.4877316 L20.4877316,2.09805481 Z\"\n                  id=\"Combined-Shape\"\n                ></path>\n              </g>\n            </g>\n          </g>\n        );\n      case TYPE_SCREEN:\n        return (\n          <path\n            fill={getFillColor()}\n            fillRule=\"evenodd\"\n            d=\"M2 5.006C2 3.898 2.898 3 3.99 3h16.02C21.108 3 22 3.897 22 5.006v9.988A2.003 2.003 0 0 1 20.01 17H3.99C2.892 17 2 16.103 2 14.994V5.006zm2 .99v8.009c0 .54.448.995 1 .995h14c.555 0 1-.446 1-.995v-8.01c0-.54-.448-.995-1-.995H5c-.555 0-1 .446-1 .995zM7 20c0-.552.456-1 .995-1h8.01c.55 0 .995.444.995 1 0 .552-.456 1-.995 1h-8.01A.995.995 0 0 1 7 20z\"\n          />\n        );\n      case TYPE_LEAVE:\n        return (\n          <path\n            d=\"M19.347 11l-1.71-1.638a.832.832 0 0 1 0-1.222l.03-.03a.922.922 0 0 1 1.27-.003l3.34 3.2a.95.95 0 0 1 0 1.386l-3.34 3.2a.918.918 0 0 1-1.27-.003l-.03-.03a.842.842 0 0 1 0-1.221L19.348 13h-7.352A.995.995 0 0 1 11 12c0-.552.456-1 .995-1h7.352zM16 10h-2V7.995c0-.54-.446-.995-.997-.995H6.997A1 1 0 0 0 6 7.995v8.01c0 .54.446.995.997.995h6.006a1 1 0 0 0 .997-.995V14h2v2.994A2.009 2.009 0 0 1 13.991 19H6.01A2.007 2.007 0 0 1 4 16.994V7.006C4 5.898 4.902 5 6.009 5h7.982C15.101 5 16 5.897 16 7.006V10z\"\n            fill={getFillColor()}\n            fillRule=\"evenodd\"\n          />\n        );\n      default:\n        throw new Error();\n    }\n  }\n\n  return (\n    <svg\n      width=\"24px\"\n      height=\"24px\"\n      viewBox=\"0 0 24 24\"\n      className={props.className}\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      {getPath()}\n    </svg>\n  );\n}\n\nexport { TYPE_MUTE_CAMERA, TYPE_MUTE_MIC, TYPE_SCREEN, TYPE_LEAVE };\n","import React from 'react';\nimport './TrayButton.css';\nimport Icon, {\n  TYPE_MUTE_CAMERA,\n  TYPE_MUTE_MIC,\n  TYPE_SCREEN,\n  TYPE_LEAVE,\n} from '../Icon/Icon';\n\n/**\n * Props:\n * - type: string\n * - disabled: boolean\n * - highlighted: boolean\n * - onClick: () => ()\n * - newButtonGroup: boolean\n */\nexport default function TrayButton(props) {\n  return (\n    <button\n      disabled={props.disabled}\n      onClick={props.onClick}\n      className={'tray-button' + (props.newButtonGroup ? ' new-group' : '')}\n    >\n      <Icon type={props.type} highlighted={props.highlighted} />\n    </button>\n  );\n}\n\nexport { TYPE_MUTE_CAMERA, TYPE_MUTE_MIC, TYPE_SCREEN, TYPE_LEAVE };\n","import React, { useContext, useEffect, useState } from 'react';\nimport './Tray.css';\nimport TrayButton, {\n  TYPE_MUTE_CAMERA,\n  TYPE_MUTE_MIC,\n  TYPE_SCREEN,\n  TYPE_LEAVE,\n} from '../TrayButton/TrayButton';\nimport CallObjectContext from '../../CallObjectContext';\nimport { logDailyEvent } from '../../logUtils';\nimport DailyIframe from '@daily-co/daily-js';\n\n/**\n * Gets [isCameraMuted, isMicMuted, isSharingScreen].\n * This function is declared outside Tray() so it's not recreated every render\n * (which would require us to declare it as a useEffect dependency).\n */\nfunction getStreamStates(callObject) {\n  let isCameraMuted,\n    isMicMuted,\n    isSharingScreen = false;\n  if (\n    callObject &&\n    callObject.participants() &&\n    callObject.participants().local\n  ) {\n    const localParticipant = callObject.participants().local;\n    isCameraMuted = !localParticipant.video;\n    isMicMuted = !localParticipant.audio;\n    isSharingScreen = localParticipant.screen;\n  }\n  return [isCameraMuted, isMicMuted, isSharingScreen];\n}\n\n/**\n * Props:\n * - onClickLeaveCall: () => ()\n * - disabled: boolean\n */\nexport default function Tray(props) {\n  const callObject = useContext(CallObjectContext);\n  const [isCameraMuted, setCameraMuted] = useState(false);\n  const [isMicMuted, setMicMuted] = useState(false);\n  const [isSharingScreen, setSharingScreen] = useState(false);\n\n  function toggleCamera() {\n    callObject.setLocalVideo(isCameraMuted);\n  }\n\n  function toggleMic() {\n    callObject.setLocalAudio(isMicMuted);\n  }\n\n  function toggleSharingScreen() {\n    isSharingScreen\n      ? callObject.stopScreenShare()\n      : callObject.startScreenShare();\n  }\n\n  function leaveCall() {\n    props.onClickLeaveCall && props.onClickLeaveCall();\n  }\n\n  /**\n   * Start listening for participant changes when callObject is set (i.e. when the component mounts).\n   * This event will capture any changes to your audio/video mute state.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleNewParticipantsState(event) {\n      event && logDailyEvent(event);\n      const [isCameraMuted, isMicMuted, isSharingScreen] = getStreamStates(\n        callObject\n      );\n      setCameraMuted(isCameraMuted);\n      setMicMuted(isMicMuted);\n      setSharingScreen(isSharingScreen);\n    }\n\n    // Use initial state\n    handleNewParticipantsState();\n\n    // Listen for changes in state\n    callObject.on('participant-updated', handleNewParticipantsState);\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      callObject.off('participant-updated', handleNewParticipantsState);\n    };\n  }, [callObject]);\n\n  return (\n    <div className=\"tray\">\n      <TrayButton\n        type={TYPE_MUTE_CAMERA}\n        disabled={props.disabled}\n        highlighted={isCameraMuted}\n        onClick={toggleCamera}\n      />\n      <TrayButton\n        type={TYPE_MUTE_MIC}\n        disabled={props.disabled}\n        highlighted={isMicMuted}\n        onClick={toggleMic}\n      />\n      {DailyIframe.supportedBrowser().supportsScreenShare && (\n        <TrayButton\n          type={TYPE_SCREEN}\n          disabled={props.disabled}\n          highlighted={isSharingScreen}\n          onClick={toggleSharingScreen}\n        />\n      )}\n      <TrayButton\n        type={TYPE_LEAVE}\n        disabled={props.disabled}\n        newButtonGroup={true}\n        highlighted={true}\n        onClick={leaveCall}\n      />\n    </div>\n  );\n}\n","import React, { useEffect, useState, useCallback } from 'react';\nimport Call from '../Call/Call';\nimport StartButton from '../StartButton/StartButton';\nimport api from '../../api';\nimport './App.css';\nimport Tray from '../Tray/Tray';\nimport CallObjectContext from '../../CallObjectContext';\nimport { roomUrlFromPageUrl, pageUrlFromRoomUrl } from '../../urlUtils';\nimport DailyIframe from '@daily-co/daily-js';\nimport { logDailyEvent } from '../../logUtils';\n\nconst STATE_IDLE = 'STATE_IDLE';\nconst STATE_CREATING = 'STATE_CREATING';\nconst STATE_JOINING = 'STATE_JOINING';\nconst STATE_JOINED = 'STATE_JOINED';\nconst STATE_LEAVING = 'STATE_LEAVING';\nconst STATE_ERROR = 'STATE_ERROR';\n\nexport default function App() {\n  const [appState, setAppState] = useState(STATE_IDLE);\n  const [roomUrl, setRoomUrl] = useState(null);\n  const [callObject, setCallObject] = useState(null);\n\n  /**\n   * Creates a new call room.\n   */\n  const createCall = useCallback(() => {\n    setAppState(STATE_CREATING);\n    return api\n      .createRoom()\n      .then((room) => room.url)\n      .catch((error) => {\n        console.log('Error creating room', error);\n        setRoomUrl(null);\n        setAppState(STATE_IDLE);\n      });\n  }, []);\n\n  /**\n   * Starts joining an existing call.\n   *\n   * NOTE: In this demo we show how to completely clean up a call with destroy(),\n   * which requires creating a new call object before you can join() again.\n   * This isn't strictly necessary, but is good practice when you know you'll\n   * be done with the call object for a while and you're no longer listening to its\n   * events.\n   */\n  const startJoiningCall = useCallback((url) => {\n    const newCallObject = DailyIframe.createCallObject();\n    setRoomUrl(url);\n    setCallObject(newCallObject);\n    setAppState(STATE_JOINING);\n    newCallObject.join({ url });\n  }, []);\n\n  /**\n   * Starts leaving the current call.\n   */\n  const startLeavingCall = useCallback(() => {\n    if (!callObject) return;\n    setAppState(STATE_LEAVING);\n    callObject.leave();\n  }, [callObject]);\n\n  /**\n   * If a room's already specified in the page's URL when the component mounts,\n   * join the room.\n   */\n  useEffect(() => {\n    const url = roomUrlFromPageUrl();\n    url && startJoiningCall(url);\n  }, [startJoiningCall]);\n\n  /**\n   * Update the page's URL to reflect the active call when roomUrl changes.\n   *\n   * This demo uses replaceState rather than pushState in order to avoid a bit\n   * of state-management complexity. See the comments around enableCallButtons\n   * and enableStartButton for more information.\n   */\n  useEffect(() => {\n    const pageUrl = pageUrlFromRoomUrl(roomUrl);\n    if (pageUrl === window.location.href) return;\n    window.history.replaceState(null, null, pageUrl);\n  }, [roomUrl]);\n\n  /**\n   * Uncomment to attach call object to window for debugging purposes.\n   */\n  // useEffect(() => {\n  //   window.callObject = callObject;\n  // }, [callObject]);\n\n  /**\n   * Update app state based on reported meeting state changes.\n   *\n   * NOTE: Here we're showing how to completely clean up a call with destroy().\n   * This isn't strictly necessary between join()s, but is good practice when\n   * you know you'll be done with the call object for a while and you're no\n   * longer listening to its events.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    const events = ['joined-meeting', 'left-meeting', 'error'];\n\n    function handleNewMeetingState(event) {\n      event && logDailyEvent(event);\n      switch (callObject.meetingState()) {\n        case 'joined-meeting':\n          setAppState(STATE_JOINED);\n          break;\n        case 'left-meeting':\n          callObject.destroy().then(() => {\n            setRoomUrl(null);\n            setCallObject(null);\n            setAppState(STATE_IDLE);\n          });\n          break;\n        case 'error':\n          setAppState(STATE_ERROR);\n          break;\n        default:\n          break;\n      }\n    }\n\n    // Use initial state\n    handleNewMeetingState();\n\n    // Listen for changes in state\n    for (const event of events) {\n      callObject.on(event, handleNewMeetingState);\n    }\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      for (const event of events) {\n        callObject.off(event, handleNewMeetingState);\n      }\n    };\n  }, [callObject]);\n\n  /**\n   * Listen for app messages from other call participants.\n   */\n  useEffect(() => {\n    if (!callObject) {\n      return;\n    }\n\n    function handleAppMessage(event) {\n      if (event) {\n        logDailyEvent(event);\n        console.log(`received app message from ${event.fromId}: `, event.data);\n      }\n    }\n\n    callObject.on('app-message', handleAppMessage);\n\n    return function cleanup() {\n      callObject.off('app-message', handleAppMessage);\n    };\n  }, [callObject]);\n\n  /**\n   * Show the call UI if we're either joining, already joined, or are showing\n   * an error.\n   */\n  const showCall = [STATE_JOINING, STATE_JOINED, STATE_ERROR].includes(\n    appState\n  );\n\n  /**\n   * Only enable the call buttons (camera toggle, leave call, etc.) if we're joined\n   * or if we've errored out.\n   *\n   * !!!\n   * IMPORTANT: calling callObject.destroy() *before* we get the \"joined-meeting\"\n   * can result in unexpected behavior. Disabling the leave call button\n   * until then avoids this scenario.\n   * !!!\n   */\n  const enableCallButtons = [STATE_JOINED, STATE_ERROR].includes(appState);\n\n  /**\n   * Only enable the start button if we're in an idle state (i.e. not creating,\n   * joining, etc.).\n   *\n   * !!!\n   * IMPORTANT: only one call object is meant to be used at a time. Creating a\n   * new call object with DailyIframe.createCallObject() *before* your previous\n   * callObject.destroy() completely finishes can result in unexpected behavior.\n   * Disabling the start button until then avoids that scenario.\n   * !!!\n   */\n  const enableStartButton = appState === STATE_IDLE;\n\n  return (\n    <div className=\"app\">\n      {showCall ? (\n        // NOTE: for an app this size, it's not obvious that using a Context\n        // is the best choice. But for larger apps with deeply-nested components\n        // that want to access call object state and bind event listeners to the\n        // call object, this can be a helpful pattern.\n        <CallObjectContext.Provider value={callObject}>\n          <Call roomUrl={roomUrl} />\n          <Tray\n            disabled={!enableCallButtons}\n            onClickLeaveCall={startLeavingCall}\n          />\n        </CallObjectContext.Provider>\n      ) : (\n        <StartButton\n          disabled={!enableStartButton}\n          onClick={() => {\n            createCall().then((url) => startJoiningCall(url));\n          }}\n        />\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App/App';\nimport BrowserUnsupported from './components/BrowserUnsupported/BrowserUnsupported';\nimport DailyIframe from '@daily-co/daily-js';\n\nReactDOM.render(\n  DailyIframe.supportedBrowser().supported ? <App /> : <BrowserUnsupported />,\n  document.getElementById('root')\n);\n","export function roomUrlFromPageUrl() {\n  const match = window.location.search.match(/roomUrl=([^&]+)/i);\n  return match && match[1] ? decodeURIComponent(match[1]) : null;\n}\n\nexport function pageUrlFromRoomUrl(roomUrl) {\n  return (\n    window.location.href.split('?')[0] +\n    (roomUrl ? `?roomUrl=${encodeURIComponent(roomUrl)}` : '')\n  );\n}\n","import React from 'react';\nimport './BrowserUnsupported.css';\n\nexport default function BrowserUnsupported() {\n  return (\n    <p class=\"browser-unsupported\">\n      Looks like you need to upgrade your browser to make Daily.co video calls.\n      <br />\n      See&nbsp;\n      <a href=\"https://help.daily.co/en/articles/3179421-what-browser-version-does-daily-co-require\">\n        this page\n      </a>\n      &nbsp;for help getting on a supported browser version.\n    </p>\n  );\n}\n"],"sourceRoot":""}